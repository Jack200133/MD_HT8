<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MD_HDT8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HDT_8_files/libs/clipboard/clipboard.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/quarto.js"></script>
<script src="HDT_8_files/libs/quarto-html/popper.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/anchor.min.js"></script>
<link href="HDT_8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HDT_8_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HDT_8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HDT_8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HDT_8_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MD_HDT8</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"train.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dvisión-de-variables-numéricas-y-obtención-de-data-de-prueba-y-entrenamiento" class="level2">
<h2 class="anchored" data-anchor-id="dvisión-de-variables-numéricas-y-obtención-de-data-de-prueba-y-entrenamiento">1. Dvisión de variables numéricas y obtención de data de prueba y entrenamiento</h2>
<section id="transformación-y-división-de-variables" class="level3">
<h3 class="anchored" data-anchor-id="transformación-y-división-de-variables">1.1 Transformación y división de variables</h3>
<p>Al observar las variables se puede evidenciar que hay diferentes variables que tienen datos en diferentes escalas. Además, del análisis exploratorio previo se sabe que las variables no siguen distribuciones normales, así que se escalaron y normalizaron las variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Id MSSubClass MSZoning LotFrontage LotArea Street Alley LotShape LandContour
1  1         60       RL          65    8450   Pave  &lt;NA&gt;      Reg         Lvl
2  2         20       RL          80    9600   Pave  &lt;NA&gt;      Reg         Lvl
3  3         60       RL          68   11250   Pave  &lt;NA&gt;      IR1         Lvl
4  4         70       RL          60    9550   Pave  &lt;NA&gt;      IR1         Lvl
5  5         60       RL          84   14260   Pave  &lt;NA&gt;      IR1         Lvl
6  6         50       RL          85   14115   Pave  &lt;NA&gt;      IR1         Lvl
  Utilities LotConfig LandSlope Neighborhood Condition1 Condition2 BldgType
1    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam
2    AllPub       FR2       Gtl      Veenker      Feedr       Norm     1Fam
3    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam
4    AllPub    Corner       Gtl      Crawfor       Norm       Norm     1Fam
5    AllPub       FR2       Gtl      NoRidge       Norm       Norm     1Fam
6    AllPub    Inside       Gtl      Mitchel       Norm       Norm     1Fam
  HouseStyle OverallQual OverallCond YearBuilt YearRemodAdd RoofStyle RoofMatl
1     2Story           7           5      2003         2003     Gable  CompShg
2     1Story           6           8      1976         1976     Gable  CompShg
3     2Story           7           5      2001         2002     Gable  CompShg
4     2Story           7           5      1915         1970     Gable  CompShg
5     2Story           8           5      2000         2000     Gable  CompShg
6     1.5Fin           5           5      1993         1995     Gable  CompShg
  Exterior1st Exterior2nd MasVnrType MasVnrArea ExterQual ExterCond Foundation
1     VinylSd     VinylSd    BrkFace        196        Gd        TA      PConc
2     MetalSd     MetalSd       None          0        TA        TA     CBlock
3     VinylSd     VinylSd    BrkFace        162        Gd        TA      PConc
4     Wd Sdng     Wd Shng       None          0        TA        TA     BrkTil
5     VinylSd     VinylSd    BrkFace        350        Gd        TA      PConc
6     VinylSd     VinylSd       None          0        TA        TA       Wood
  BsmtQual BsmtCond BsmtExposure BsmtFinType1 BsmtFinSF1 BsmtFinType2
1       Gd       TA           No          GLQ        706          Unf
2       Gd       TA           Gd          ALQ        978          Unf
3       Gd       TA           Mn          GLQ        486          Unf
4       TA       Gd           No          ALQ        216          Unf
5       Gd       TA           Av          GLQ        655          Unf
6       Gd       TA           No          GLQ        732          Unf
  BsmtFinSF2 BsmtUnfSF TotalBsmtSF Heating HeatingQC CentralAir Electrical
1          0       150         856    GasA        Ex          Y      SBrkr
2          0       284        1262    GasA        Ex          Y      SBrkr
3          0       434         920    GasA        Ex          Y      SBrkr
4          0       540         756    GasA        Gd          Y      SBrkr
5          0       490        1145    GasA        Ex          Y      SBrkr
6          0        64         796    GasA        Ex          Y      SBrkr
  X1stFlrSF X2ndFlrSF LowQualFinSF GrLivArea BsmtFullBath BsmtHalfBath FullBath
1       856       854            0      1710            1            0        2
2      1262         0            0      1262            0            1        2
3       920       866            0      1786            1            0        2
4       961       756            0      1717            1            0        1
5      1145      1053            0      2198            1            0        2
6       796       566            0      1362            1            0        1
  HalfBath BedroomAbvGr KitchenAbvGr KitchenQual TotRmsAbvGrd Functional
1        1            3            1          Gd            8        Typ
2        0            3            1          TA            6        Typ
3        1            3            1          Gd            6        Typ
4        0            3            1          Gd            7        Typ
5        1            4            1          Gd            9        Typ
6        1            1            1          TA            5        Typ
  Fireplaces FireplaceQu GarageType GarageYrBlt GarageFinish GarageCars
1          0        &lt;NA&gt;     Attchd        2003          RFn          2
2          1          TA     Attchd        1976          RFn          2
3          1          TA     Attchd        2001          RFn          2
4          1          Gd     Detchd        1998          Unf          3
5          1          TA     Attchd        2000          RFn          3
6          0        &lt;NA&gt;     Attchd        1993          Unf          2
  GarageArea GarageQual GarageCond PavedDrive WoodDeckSF OpenPorchSF
1        548         TA         TA          Y          0          61
2        460         TA         TA          Y        298           0
3        608         TA         TA          Y          0          42
4        642         TA         TA          Y          0          35
5        836         TA         TA          Y        192          84
6        480         TA         TA          Y         40          30
  EnclosedPorch X3SsnPorch ScreenPorch PoolArea PoolQC Fence MiscFeature
1             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
2             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
3             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
4           272          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
5             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
6             0        320           0        0   &lt;NA&gt; MnPrv        Shed
  MiscVal MoSold YrSold SaleType SaleCondition SalePrice
1       0      2   2008       WD        Normal    208500
2       0      5   2007       WD        Normal    181500
3       0      9   2008       WD        Normal    223500
4       0      2   2006       WD       Abnorml    140000
5       0     12   2008       WD        Normal    250000
6     700     10   2009       WD        Normal    143000</code></pre>
</div>
</div>
</section>
<section id="creación-de-clasificación-de-la-variable-de-precios" class="level3">
<h3 class="anchored" data-anchor-id="creación-de-clasificación-de-la-variable-de-precios">1.2. Creación de clasificación de la variable de precios</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p33 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(datos<span class="sc">$</span>SalePrice, <span class="fl">0.33</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p66 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(datos<span class="sc">$</span>SalePrice, <span class="fl">0.66</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">clasificacion =</span> <span class="fu">ifelse</span>(datos<span class="sc">$</span>SalePrice <span class="sc">&lt;</span> p33, <span class="st">"Economicas"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(datos<span class="sc">$</span>SalePrice <span class="sc">&lt;</span> p66, <span class="st">"Intermedias"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Caras"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>clasificacion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uso-de-train-y-test-previos" class="level3">
<h3 class="anchored" data-anchor-id="uso-de-train-y-test-previos">2. Uso de train y test previos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    SalePrice OverallQual MasVnrArea  BsmtFinSF1  GrLivArea Fireplaces
1  0.35170267  0.65665106  0.5098397  0.57982575  0.3727132 -0.9515670
2  0.01116139 -0.06731047 -0.5726373  1.17715497 -0.4796010  0.6026234
3  0.54089227  0.65665106  0.3220631  0.09669182  0.5173022  0.6026234
4 -0.51226318  0.65665106 -0.5726373 -0.49624527  0.3860306  0.6026234
5  0.87512723  1.38061260  1.3603573  0.46782652  1.3011269  0.6026234
6 -0.47442526 -0.79127201 -0.5726373  0.63692339 -0.2893523 -0.9515670
  WoodDeckSF OpenPorchSF TotalBsmtSF clasificacion
1 -0.7529618   0.2211932  -0.4561479         Caras
2  1.6235530  -0.7023689   0.4705408   Intermedias
3 -0.7529618  -0.0664737  -0.3100689         Caras
4 -0.7529618  -0.1724562  -0.6843964   Intermedias
5  0.7782156   0.5694215   0.2034901         Caras
6 -0.4339665  -0.2481580  -0.5930970   Intermedias</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>porcentaje <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>corte <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos), <span class="fu">nrow</span>(datos) <span class="sc">*</span> porcentaje)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> datos[corte, ]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>corte, ]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">select</span>(train, <span class="sc">-</span>SalePrice)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">select</span>(test, <span class="sc">-</span>SalePrice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="generar-dos-modelos-de-redes-neuronales-predicciones-y-matrices." class="level2">
<h2 class="anchored" data-anchor-id="generar-dos-modelos-de-redes-neuronales-predicciones-y-matrices.">3. Generar dos modelos de redes neuronales, predicciones y matrices.</h2>
<section id="primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo">3.1 Primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">decay =</span> <span class="fl">0.1</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"logistic"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pm1 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="segundo-modelo" class="level2">
<h2 class="anchored" data-anchor-id="segundo-modelo">3.2 Segundo modelo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">decay =</span> <span class="fl">0.1</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"sigmoid"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>pm2 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicciones" class="level2">
<h2 class="anchored" data-anchor-id="predicciones">4. Predicciones</h2>
<section id="predicción-con-primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-primer-modelo">4.1 Predicción con primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>prediccion1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo1, <span class="at">newdata =</span> test)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cfm1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion1, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicción-con-segundo-modelo" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-segundo-modelo">4.2 Predicción con segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prediccion2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo2, <span class="at">newdata =</span> test)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cfm2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion2, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="matrices-de-confusión-de-modelos" class="level2">
<h2 class="anchored" data-anchor-id="matrices-de-confusión-de-modelos">5. Matrices de confusión de modelos</h2>
<section id="matriz-de-primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="matriz-de-primer-modelo">5.1 Matriz de primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cfm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         126          4          16
  Economicas      0        121          25
  Intermedias    17         27         100

Overall Statistics
                                          
               Accuracy : 0.7959          
                 95% CI : (0.7549, 0.8327)
    No Information Rate : 0.3486          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6938          
                                          
 Mcnemar's Test P-Value : 0.2501          

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8811            0.7961             0.7092
Specificity                0.9317            0.9120             0.8508
Pos Pred Value             0.8630            0.8288             0.6944
Neg Pred Value             0.9414            0.8931             0.8596
Prevalence                 0.3280            0.3486             0.3234
Detection Rate             0.2890            0.2775             0.2294
Detection Prevalence       0.3349            0.3349             0.3303
Balanced Accuracy          0.9064            0.8540             0.7800</code></pre>
</div>
</div>
</section>
<section id="matriz-de-segundo-modelo" class="level3">
<h3 class="anchored" data-anchor-id="matriz-de-segundo-modelo">5.2 Matriz de segundo modelo</h3>
<p>La matriz para el segundo modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cfm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         121          3          21
  Economicas      1        126          20
  Intermedias    21         23         100

Overall Statistics
                                          
               Accuracy : 0.7959          
                 95% CI : (0.7549, 0.8327)
    No Information Rate : 0.3486          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6938          
                                          
 Mcnemar's Test P-Value : 0.7508          

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8462            0.8289             0.7092
Specificity                0.9181            0.9261             0.8508
Pos Pred Value             0.8345            0.8571             0.6944
Neg Pred Value             0.9244            0.9100             0.8596
Prevalence                 0.3280            0.3486             0.3234
Detection Rate             0.2775            0.2890             0.2294
Detection Prevalence       0.3326            0.3372             0.3303
Balanced Accuracy          0.8821            0.8775             0.7800</code></pre>
</div>
</div>
</section>
</section>
<section id="comparacion-de-resultados" class="level2">
<h2 class="anchored" data-anchor-id="comparacion-de-resultados">6 Comparacion de resultados</h2>
<section id="red-neuronal-1" class="level3">
<h3 class="anchored" data-anchor-id="red-neuronal-1">Red neuronal 1</h3>
<p>Este modelo obtuvo un accurracy de 0.754 Este modelo obtuvo un tiempo de procesamiento de 1.66 El modelo obtuvo un sensitivity de 0.855 y un specificity de 0.899 indicando asi que modelo no tiene tantas equivocaciones.</p>
</section>
<section id="red-neuronal-2" class="level3">
<h3 class="anchored" data-anchor-id="red-neuronal-2">Red neuronal 2</h3>
<p>Este modelo obtuvo un accurracy de 0.719 Este modelo obtuvo un tiempo de procesamiento de 5.52 El modelo obtuvo un sensitivity de 0.789 y un specificity de 0.919 indicando asi que modelo no tiene tantas equivocaciones.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Segun los datos que se observan anteriormente se puede definir que el mejor modelo de las dos redes neuronales es la primera, la cual tiene una solo una capa de 16 neuronas.</p>
</section>
</section>
<section id="análisis-de-overfitting" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-overfitting">7. Análisis de overfitting</h2>
<section id="primer-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo-1">7.1 Primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    datos.task <span class="ot">=</span> <span class="fu">makeClassifTask</span>(<span class="at">data =</span> train, <span class="at">target =</span> <span class="st">"clasificacion"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    rin2 <span class="ot">=</span> <span class="fu">makeResampleDesc</span>(<span class="at">method =</span> <span class="st">"CV"</span>, <span class="at">iters =</span> <span class="dv">10</span>, <span class="at">predict =</span> <span class="st">"both"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    lrn <span class="ot">=</span> <span class="fu">makeLearner</span>(<span class="st">"classif.nnet"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">decay =</span> <span class="fl">1e-4</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    lc2 <span class="ot">=</span> <span class="fu">generateLearningCurveData</span>(<span class="at">learners =</span> lrn, <span class="at">task =</span> datos.task,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">percs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">measures =</span> <span class="fu">list</span>(ber, <span class="fu">setAggregation</span>(ber, train.mean)), <span class="at">resampling =</span> rin2,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show.info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotLearningCurve</span>(lc2, <span class="at">facet =</span> <span class="st">"learner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tras observar la curva de aprendizaje, se puede notar que la curva de training siempre va en ascenso, mientras mayor cantidad de datos mayor es la curva lo que indica que el modelo no posee un infra ajuste. Por otro lado, al observar la curva de test se nota que al final con el último grupo de datos en lugar de que la curva disminuye va en aumento lo que no debe de pasar, indicando así que el modelo posee sobreajuste. Además, se puede reforzar esta conclusión al notar que las dos curvas nunca llegan a converger y la distancia entre ellas es muy amplia.</p>
</section>
<section id="segundo-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="segundo-modelo-1">7.2 Segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    datos.task <span class="ot">=</span> <span class="fu">makeClassifTask</span>(<span class="at">data =</span> train, <span class="at">target =</span> <span class="st">"clasificacion"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    rin2 <span class="ot">=</span> <span class="fu">makeResampleDesc</span>(<span class="at">method =</span> <span class="st">"CV"</span>, <span class="at">iters =</span> <span class="dv">10</span>, <span class="at">predict =</span> <span class="st">"both"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    lrn <span class="ot">=</span> <span class="fu">makeLearner</span>(<span class="st">"classif.nnet"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">decay =</span> <span class="fl">1e-4</span>, <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    lc2 <span class="ot">=</span> <span class="fu">generateLearningCurveData</span>(<span class="at">learners =</span> lrn, <span class="at">task =</span> datos.task,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">percs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">measures =</span> <span class="fu">list</span>(ber, <span class="fu">setAggregation</span>(ber, train.mean)), <span class="at">resampling =</span> rin2,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show.info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotLearningCurve</span>(lc2, <span class="at">facet =</span> <span class="st">"learner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El segundo modelo se evidencia en su curva de aprendizaje que tiene overfitting. Se aprecia que la curva de entrenamiento sube cuando se tienen más datos, lo cual indica que el modelo se está ajustando mucho a ellos. Además, existe un espacio demasiado grande entre curvas. Este sobreajuste se puede deber a que la complejidad del modelo es demasiado alta para los datos que se tienen. También es posible que se tengan muy pocos datos y/o features.</p>
</section>
</section>
<section id="tuneo-de-parametros" class="level2">
<h2 class="anchored" data-anchor-id="tuneo-de-parametros">8. Tuneo de parametros</h2>
<section id="tuneo" class="level3">
<h3 class="anchored" data-anchor-id="tuneo">8.1 Tuneo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grid &lt;- expand.grid(size = c(2, 4, 6, 10),</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                     decay = c(0.01, 0.1, 0.5, 1.5, 1.25))</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo_tuneado &lt;- caret::train(clasificacion ~ ., </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                data = train, </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  method = "nnet", </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  trace = F, </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                tuneGrid = grid, </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                nnet = list(droput = 0.5), </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                maxit = 100)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo_tuneado$bestTune</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(modelo_tuneado)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Resample Result
Task: train_50
Learner: classif.nnet.tuned
Aggr perf: ber.test.mean=0.2589133
Runtime: 103.034</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$size
[1] 8

$decay
[1] 1.107771</code></pre>
</div>
</div>
<p>Al utilizar crossvalidation con parameter tuning, se obtuvo que la mejor cantidad de neuronas es 10 y el mejor decay es 1.26 aproximadamente. A pesar de que estos valores puede que mejoren un poco el accuracy, el overfitting es muy probable que se mantenga.</p>
</section>
<section id="modelo-tuneado" class="level3">
<h3 class="anchored" data-anchor-id="modelo-tuneado">8.2 Modelo Tuneado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>modelo3 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">decay =</span> <span class="fl">1.258925</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"logistic"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>pm3 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>prediccion3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3, <span class="at">newdata =</span> test)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cfm3 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion3, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cfm3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         125          2          15
  Economicas      0        124          26
  Intermedias    18         26         100

Overall Statistics
                                         
               Accuracy : 0.8005         
                 95% CI : (0.7598, 0.837)
    No Information Rate : 0.3486         
    P-Value [Acc &gt; NIR] : &lt;2e-16         
                                         
                  Kappa : 0.7006         
                                         
 Mcnemar's Test P-Value : 0.5178         

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8741            0.8158             0.7092
Specificity                0.9420            0.9085             0.8508
Pos Pred Value             0.8803            0.8267             0.6944
Neg Pred Value             0.9388            0.9021             0.8596
Prevalence                 0.3280            0.3486             0.3234
Detection Rate             0.2867            0.2844             0.2294
Detection Prevalence       0.3257            0.3440             0.3303
Balanced Accuracy          0.9081            0.8621             0.7800</code></pre>
</div>
</div>
<p>Se obtuvo un accuracy de 0.80, un 0.04 arriba del mejor accuracy anterior. Se tiene una diferencia importante entre modelos al hacer el tuneo de parámetros, es posible que se haya mantenido el overfitting.</p>
</section>
</section>
<section id="selección-de-saleprice-como-variable-respuesta" class="level2">
<h2 class="anchored" data-anchor-id="selección-de-saleprice-como-variable-respuesta">9. Selección de SalePrice como variable respuesta</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>porcentaje <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>corte <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos), <span class="fu">nrow</span>(datos) <span class="sc">*</span> porcentaje)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> datos[corte, ]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>corte, ]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> train[, multi_variables]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> test[, multi_variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelos-de-regresión-lineal-con-redes-neuronales." class="level2">
<h2 class="anchored" data-anchor-id="modelos-de-regresión-lineal-con-redes-neuronales.">10. Modelos de regresión lineal con redes neuronales.</h2>
<section id="primer-modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo-2">10.1 Primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(SalePrice<span class="sc">~</span>., train, <span class="at">hidden =</span> <span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">3</span>, <span class="at">act.fct =</span> <span class="st">"logistic"</span>,<span class="at">linear.output =</span> <span class="cn">TRUE</span> )</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>pm1 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="segundo-modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="segundo-modelo-2">10.2 Segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(SalePrice <span class="sc">~</span> ., <span class="at">data=</span>train, <span class="at">threshold=</span><span class="fl">0.0001</span>, <span class="at">act.fct =</span> <span class="st">"tanh"</span>,<span class="at">err.fct =</span> <span class="st">"sse"</span>,<span class="at">linear.output =</span> <span class="cn">TRUE</span> )</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>pm2 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="predicción" class="level2">
<h2 class="anchored" data-anchor-id="predicción">11. Predicción</h2>
<section id="predicción-con-primer-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-primer-modelo-1">11.1 Predicción con primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>prediction_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1, test)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((test<span class="sc">$</span>SalePrice <span class="sc">-</span> prediction_1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((test<span class="sc">$</span>SalePrice<span class="sc">-</span> prediction_1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((test<span class="sc">$</span>SalePrice <span class="sc">-</span> <span class="fu">mean</span>(test<span class="sc">$</span>SalePrice))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>prediction_1_train <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">predict</span>(model1, <span class="at">newdata =</span> train), <span class="dv">0</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>R_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR <span class="sc">/</span> SST)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1554653</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>RMSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3942908</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>R_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8322607</code></pre>
</div>
</div>
</section>
<section id="predicción-con-segundo-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-segundo-modelo-1">11.2 Predicción con segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>prediction_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, test)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((test<span class="sc">$</span>SalePrice <span class="sc">-</span> prediction_2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((test<span class="sc">$</span>SalePrice<span class="sc">-</span> prediction_2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((test<span class="sc">$</span>SalePrice <span class="sc">-</span> <span class="fu">mean</span>(test<span class="sc">$</span>SalePrice))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>prediction_2_train <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">predict</span>(model2, <span class="at">newdata =</span> train), <span class="dv">0</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>R_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR <span class="sc">/</span> SST)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1362754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>RMSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.369155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>R_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8529656</code></pre>
</div>
</div>
<p>Se puede observar que ambos modelos fueron bastante buenos para realizar la predicción de los precios de las casas. Se tuvo un bajo MSE y RMSE en ambos modelos. El mejor modelo fue el segundo, teniendo 0.02 puntos menos en MSE que el primero. Además, su R^2 fue mejor, con un valor de 0.85 sobre 0.83. Estos valores altos indican que puede existir overfitting, porque la red neuronal no es muy compleja y aun así se tiene un R^2 bastante alto, lo cual indica que la red neuronal puede estarse adecuando mucho a los datos.</p>
</section>
</section>
<section id="analice-si-no-hay-sobreajuste" class="level2">
<h2 class="anchored" data-anchor-id="analice-si-no-hay-sobreajuste">12. Analice si no hay sobreajuste</h2>
<section id="modelo-1-analisis-de-sobreajuste" class="level3">
<h3 class="anchored" data-anchor-id="modelo-1-analisis-de-sobreajuste">Modelo 1 analisis de sobreajuste</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>    mse_train <span class="ot">&lt;-</span> <span class="fu">mean</span>((prediction_1_train <span class="sc">-</span> train<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    mse_test <span class="ot">&lt;-</span> <span class="fu">mean</span>((prediction_1 <span class="sc">-</span> test<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    train_errors <span class="ot">&lt;-</span> (prediction_1_train <span class="sc">-</span> train<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    test_errors <span class="ot">&lt;-</span> (prediction_1 <span class="sc">-</span> test<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">seq_along</span>(train_errors), train_errors, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">420</span>), <span class="at">xlab=</span><span class="st">"Observation"</span>, <span class="at">ylab=</span><span class="st">"MSE"</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">seq_along</span>(test_errors), test_errors, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Train"</span>, <span class="st">"Test"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(train<span class="sc">$</span>SalePrice,<span class="at">k =</span> <span class="dv">10</span>, <span class="at">list =</span> <span class="cn">TRUE</span>, <span class="at">returnTrain =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    rmse_train <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(folds))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    rmse_test <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(folds))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folds)){</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="ot">&lt;-</span> train[folds[[i]],]</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        test_data <span class="ot">&lt;-</span> train[<span class="sc">-</span>folds[[i]],]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        pred_train<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">predict</span>(model1,<span class="at">newdata =</span> train_data ),<span class="dv">0</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        pred<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">predict</span>(model1,<span class="at">newdata =</span> test_data),<span class="dv">0</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        rmse_train[i] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_train, train_data<span class="sc">$</span>SalePrice)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>          rmse_test[i] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test_data<span class="sc">$</span>SalePrice)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>      rmse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fold =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folds),</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_Train =</span> rmse_train,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE_Test =</span> rmse_test</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a> ) </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rmse_df, <span class="fu">aes</span>(<span class="at">x =</span> Fold)) <span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> RMSE_Train, <span class="at">color =</span> <span class="st">"Conjunto de training"</span>)) <span class="sc">+</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> RMSE_Test, <span class="at">color =</span> <span class="st">"Conjunto de test"</span>)) <span class="sc">+</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Valores de RMSE en la validación cruzada"</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Fold"</span>,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Conjunto de training"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Conjunto de test"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modelo-2-analisis-de-sobreajuste" class="level3">
<h3 class="anchored" data-anchor-id="modelo-2-analisis-de-sobreajuste">Modelo 2 analisis de sobreajuste</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>      mse_train <span class="ot">&lt;-</span> <span class="fu">mean</span>((prediction_2_train <span class="sc">-</span> train<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>      mse_test <span class="ot">&lt;-</span> <span class="fu">mean</span>((prediction_2 <span class="sc">-</span> test<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    train_errors <span class="ot">&lt;-</span> (prediction_2_train <span class="sc">-</span> train<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    test_errors <span class="ot">&lt;-</span> (prediction_2 <span class="sc">-</span> test<span class="sc">$</span>SalePrice)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">seq_along</span>(train_errors), train_errors, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">420</span>), <span class="at">xlab=</span><span class="st">"Observation"</span>, <span class="at">ylab=</span><span class="st">"MSE"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">seq_along</span>(test_errors), test_errors, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Train"</span>, <span class="st">"Test"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(train<span class="sc">$</span>SalePrice,<span class="at">k =</span> <span class="dv">10</span>, <span class="at">list =</span> <span class="cn">TRUE</span>, <span class="at">returnTrain =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    rmse_train <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(folds))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    rmse_test <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(folds))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folds)){</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="ot">&lt;-</span> train[folds[[i]],]</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        test_data <span class="ot">&lt;-</span> train[<span class="sc">-</span>folds[[i]],]</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        pred_train<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">predict</span>(model2,<span class="at">newdata =</span> train_data ),<span class="dv">0</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        pred<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">predict</span>(model2,<span class="at">newdata =</span> test_data),<span class="dv">0</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        rmse_train[i] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_train, train_data<span class="sc">$</span>SalePrice)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        rmse_test[i] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test_data<span class="sc">$</span>SalePrice)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      rmse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fold =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folds),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE_Train =</span> rmse_train,</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE_Test =</span> rmse_test</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(rmse_df, <span class="fu">aes</span>(<span class="at">x =</span> Fold)) <span class="sc">+</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> RMSE_Train, <span class="at">color =</span> <span class="st">"Conjunto de training"</span>)) <span class="sc">+</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> RMSE_Test, <span class="at">color =</span> <span class="st">"Conjunto de test"</span>)) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Valores de RMSE en la validación cruzada"</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Fold"</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Conjunto de trainig"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Conjunto de test"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HDT_8_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En las curvas de aprendijaze que se muestran anteriormente se puede notar que tanto para test como para training no existe un comportamiento normal de la curva, por lo que se puede decir que si existe sobreajuste ambos modelos. Esto se puede deber a que la red neuronal no es muy compleja y aun así se tiene un R^2 bastante alto, lo cual indica que la red neuronal puede estarse adecuando mucho a los datos.</p>
<p>En realidad estas curvas de aprendizaje muestran que los datos no son representativos. Esto puede deberse a la baja complejidad de las redes neuronales o lo opuesto, que el modelo sea demasiado complejo para la predicción de SalePrice.</p>
</section>
</section>
<section id="discuta-si-puede-mejorar-el-modelo." class="level2">
<h2 class="anchored" data-anchor-id="discuta-si-puede-mejorar-el-modelo.">13.Discuta si puede mejorar el modelo.</h2>
<p>A pe sar de haber implementado técnicas para evitar el sobreajuste en los modelos creados, tales como el ajuste de parámetros y el uso de validación cruzada con diferentes funciones de activación, así como el parámetro de dropout, estos aún presentan dicho problema. Lamentablemente, ninguna de estas técnicas ha logrado mejorar los modelos, por lo que no es factible mejorar ninguno de ellos.</p>
</section>
<section id="compare-la-eficiencia" class="level2">
<h2 class="anchored" data-anchor-id="compare-la-eficiencia">14. Compare la eficiencia</h2>
<p>El modelo 1 de RNA se tardo 7.16 ms, mientras que el modelo 2 se tardó 0.1 ms.</p>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest">Random Forest</h3>
<p>El modelo logró un accuracy de 0.8269 y un tiempo de procesamiento de 0.82 ms. Además, obtuvo una sensitivity de 0.8947 y una specificity de 0.9443, lo que sugiere que el modelo tiene un bajo índice de errores.</p>
</section>
<section id="arboles-de-decision" class="level3">
<h3 class="anchored" data-anchor-id="arboles-de-decision">Arboles de Decision</h3>
<p>El modelo logró un accuracy de 0.7312 y un tiempo de procesamiento de 0.95 ms. Asimismo, obtuvo una sensitivity de 0.7730 y una specificity de 0.9058. Estos resultados sugieren que los errores del modelo se deben principalmente a la clasificación incorrecta de verdaderos positivos.</p>
</section>
<section id="naive-bayes" class="level3">
<h3 class="anchored" data-anchor-id="naive-bayes">Naive bayes</h3>
<p>El modelo logró un accuracy de 0.7472 y un tiempo de procesamiento de 0.64 ms. Además, obtuvo una sensitivity de 0.8355 y una specificity de 0.9582, lo que sugiere que el modelo tiene un bajo índice de errores, con algunas excepciones en casos de falsos negativos.</p>
</section>
<section id="svm" class="level3">
<h3 class="anchored" data-anchor-id="svm">SVM</h3>
<p>El modelo logró un accuracy de 0.7173 y un tiempo de procesamiento de 0.72 ms. Además, obtuvo una sensitivity de 0.7368 y una specificity de 0.8837, lo que sugiere que el modelo tiene dificultades para identificar los verdaderos positivos.</p>
</section>
</section>
<section id="comparar-los-resultados-del-mejor-modelo-de-esta-hoja-para-clasificar-con-los-resultados-de-los-algoritmos-usados-para-clasificar-de-las-hojas-de-trabajo-anteriores" class="level2">
<h2 class="anchored" data-anchor-id="comparar-los-resultados-del-mejor-modelo-de-esta-hoja-para-clasificar-con-los-resultados-de-los-algoritmos-usados-para-clasificar-de-las-hojas-de-trabajo-anteriores">15. Comparar los resultados del mejor modelo de esta hoja para clasificar con los resultados de los algoritmos usados para clasificar de las hojas de trabajo anteriores</h2>
<p>Para el modelo de RNA: - accuracy de 0.7768 - sensitivity de 0.8553 - specificity de 0.9408</p>
<p>Para el modelo de Random Forest: - accuracy de 0.8269 - sensitivity de 0.8947 - specificity de 0.9443</p>
<p>Para el modelo de Arboles de Decision: - accuracy de 0.7312 - sensitivity de 0.7730 - specificity de 0.9082</p>
<p>Para el modelo de Naive Bayes: - accuracy de 0.7472 - sensitivity de 0.8355 - specificity de 0.9582</p>
<p>Para el modelo de SVM: - accuracy de 0.7173 - sensitivity de 0.7368 - specificity de 0.8837</p>
<p>En base a la métrica de accuracy, el modelo de Random Forest con un valor de 0.8269 es el mejor modelo. Además, este modelo también muestra los valores más altos de especificidad y sensibilidad. En comparación, el modelo de RNA obtuvo una exactitud de 0.7768, por lo que no es el mejor modelo para la clasificación y no parece ser mejor que los modelos previamente creados.</p>
<section id="comparar-los-resultados-del-mejor-modelo-para-predecir-el-precio-de-venta-con-los-resultados-de-los-algoritmos-usados-para-el-mismo-propósito-de-las-hojas-de-trabajo-anteriores." class="level3">
<h3 class="anchored" data-anchor-id="comparar-los-resultados-del-mejor-modelo-para-predecir-el-precio-de-venta-con-los-resultados-de-los-algoritmos-usados-para-el-mismo-propósito-de-las-hojas-de-trabajo-anteriores.">16. Comparar los resultados del mejor modelo para predecir el precio de venta con los resultados de los algoritmos usados para el mismo propósito de las hojas de trabajo anteriores.</h3>
<p>Para el modelo de regresión lineal simple: - r-cuadrado de 0.61 - RMSE de 0.58</p>
<p>Para el modelo de regresión lineal múltiple: - r-cuadrado de 0.75 - RMSE de 0.42</p>
<p>Para el modelo de SVM: - r-cuadrado de 0.81 - RMSE de 0.41</p>
<p>Para el modelo de arbol de regresión: - r-cuadrado de 0.70 - RMSE de 0.52</p>
<p>Para el modelo actual de RNA: - r-cuadrado de 0.49 - RMSE de 0.37</p>
<p>Se puede observar que el mejor modelo para predecir el precio de venta es el modelo de SVM, ya que tiene un valor de R-cuadrado de 0.81 y un RMSE de 0.41. En comparación, el modelo de RNA tiene un valor de R-cuadrado de 0.49 y un RMSE de 0.37, lo que sugiere que no es un buen modelo para predecir el precio de venta.</p>
</section>
<section id="ahora-que-ha-usado-todos-los-modelos-que-hemos-visto-y-aplicados-al-conjunto-de-datos-llegue-a-conclusiones-sobre-cual-es-o-cuales-son-los-mejores-modelos-para-clasificar-dadas-las-características-del-conjunto-de-datos.-cuál-o-cuáles-son-los-mejores-para-predecir-el-precio-de-las-casas-una-tabla-de-resumen-con-las-métricas-de-los-modelos-le-puede-resultar-muy-útil-para-esto." class="level3">
<h3 class="anchored" data-anchor-id="ahora-que-ha-usado-todos-los-modelos-que-hemos-visto-y-aplicados-al-conjunto-de-datos-llegue-a-conclusiones-sobre-cual-es-o-cuales-son-los-mejores-modelos-para-clasificar-dadas-las-características-del-conjunto-de-datos.-cuál-o-cuáles-son-los-mejores-para-predecir-el-precio-de-las-casas-una-tabla-de-resumen-con-las-métricas-de-los-modelos-le-puede-resultar-muy-útil-para-esto.">17. Ahora que ha usado todos los modelos que hemos visto y aplicados al conjunto de datos llegue a conclusiones sobre cual es o cuales son los mejores modelos para clasificar dadas las características del conjunto de datos. ¿Cuál o cuáles son los mejores para predecir el precio de las casas? Una tabla de resumen con las métricas de los modelos le puede resultar muy útil para esto.</h3>
<p>Para el modelo de regresión lineal simple: - r-cuadrado de 0.61 - RMSE de 0.58</p>
<p>Para el modelo de regresión lineal múltiple: - r-cuadrado de 0.75 - RMSE de 0.42</p>
<p>Para el modelo de SVM: - r-cuadrado de 0.81 - RMSE de 0.41</p>
<p>Para el modelo de arbol de regresión: - r-cuadrado de 0.70 - RMSE de 0.52</p>
<p>Para el modelo actual de RNA: - r-cuadrado de 0.49 - RMSE de 0.37</p>
<p>Basándonos en el análisis de los resultados obtenidos, podemos concluir que el modelo de SVM es el mejor para predecir el precio de venta, ya que presenta el valor más alto de R-cuadrado y un RMSE más bajo en comparación con los otros modelos evaluados. El modelo de regresión lineal múltiple también presenta un buen desempeño, aunque no tan alto como el modelo de SVM. Es importante tener en cuenta que la elección del mejor modelo depende de diferentes factores, como la complejidad del modelo y la interpretación de las variables, por lo que se recomienda considerar cuidadosamente los resultados y seleccionar el modelo que mejor se ajuste a las necesidades específicas del problema en cuestión.</p>
<p>En general, si se tiene un conjunto de datos con pocas variables, es posible que sea mejor utilizar un modelo más simple como un árbol de decisión. SVM es un modelo muy poderoso para clasificación, en parte por los kernels, que puede ser aplicado en datos con más variables pero tiene cierto límite por la cantidad de registros que pueden ser usados. Finalmente, una red neuronal puede ser usada con más features y con una mayor cantidad de registros.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>