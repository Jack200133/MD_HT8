<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MD_HDT8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HDT_8_files/libs/clipboard/clipboard.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/quarto.js"></script>
<script src="HDT_8_files/libs/quarto-html/popper.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HDT_8_files/libs/quarto-html/anchor.min.js"></script>
<link href="HDT_8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HDT_8_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HDT_8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HDT_8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HDT_8_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MD_HDT8</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"train.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dvisión-de-variables-numéricas-y-obtención-de-data-de-prueba-y-entrenamiento" class="level2">
<h2 class="anchored" data-anchor-id="dvisión-de-variables-numéricas-y-obtención-de-data-de-prueba-y-entrenamiento">1. Dvisión de variables numéricas y obtención de data de prueba y entrenamiento</h2>
<section id="transformación-y-división-de-variables" class="level3">
<h3 class="anchored" data-anchor-id="transformación-y-división-de-variables">1.1 Transformación y división de variables</h3>
<p>Al observar las variables se puede evidenciar que hay diferentes variables que tienen datos en diferentes escalas. Además, del análisis exploratorio previo se sabe que las variables no siguen distribuciones normales, así que se escalaron y normalizaron las variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Id MSSubClass MSZoning LotFrontage LotArea Street Alley LotShape LandContour
1  1         60       RL          65    8450   Pave  &lt;NA&gt;      Reg         Lvl
2  2         20       RL          80    9600   Pave  &lt;NA&gt;      Reg         Lvl
3  3         60       RL          68   11250   Pave  &lt;NA&gt;      IR1         Lvl
4  4         70       RL          60    9550   Pave  &lt;NA&gt;      IR1         Lvl
5  5         60       RL          84   14260   Pave  &lt;NA&gt;      IR1         Lvl
6  6         50       RL          85   14115   Pave  &lt;NA&gt;      IR1         Lvl
  Utilities LotConfig LandSlope Neighborhood Condition1 Condition2 BldgType
1    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam
2    AllPub       FR2       Gtl      Veenker      Feedr       Norm     1Fam
3    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam
4    AllPub    Corner       Gtl      Crawfor       Norm       Norm     1Fam
5    AllPub       FR2       Gtl      NoRidge       Norm       Norm     1Fam
6    AllPub    Inside       Gtl      Mitchel       Norm       Norm     1Fam
  HouseStyle OverallQual OverallCond YearBuilt YearRemodAdd RoofStyle RoofMatl
1     2Story           7           5      2003         2003     Gable  CompShg
2     1Story           6           8      1976         1976     Gable  CompShg
3     2Story           7           5      2001         2002     Gable  CompShg
4     2Story           7           5      1915         1970     Gable  CompShg
5     2Story           8           5      2000         2000     Gable  CompShg
6     1.5Fin           5           5      1993         1995     Gable  CompShg
  Exterior1st Exterior2nd MasVnrType MasVnrArea ExterQual ExterCond Foundation
1     VinylSd     VinylSd    BrkFace        196        Gd        TA      PConc
2     MetalSd     MetalSd       None          0        TA        TA     CBlock
3     VinylSd     VinylSd    BrkFace        162        Gd        TA      PConc
4     Wd Sdng     Wd Shng       None          0        TA        TA     BrkTil
5     VinylSd     VinylSd    BrkFace        350        Gd        TA      PConc
6     VinylSd     VinylSd       None          0        TA        TA       Wood
  BsmtQual BsmtCond BsmtExposure BsmtFinType1 BsmtFinSF1 BsmtFinType2
1       Gd       TA           No          GLQ        706          Unf
2       Gd       TA           Gd          ALQ        978          Unf
3       Gd       TA           Mn          GLQ        486          Unf
4       TA       Gd           No          ALQ        216          Unf
5       Gd       TA           Av          GLQ        655          Unf
6       Gd       TA           No          GLQ        732          Unf
  BsmtFinSF2 BsmtUnfSF TotalBsmtSF Heating HeatingQC CentralAir Electrical
1          0       150         856    GasA        Ex          Y      SBrkr
2          0       284        1262    GasA        Ex          Y      SBrkr
3          0       434         920    GasA        Ex          Y      SBrkr
4          0       540         756    GasA        Gd          Y      SBrkr
5          0       490        1145    GasA        Ex          Y      SBrkr
6          0        64         796    GasA        Ex          Y      SBrkr
  X1stFlrSF X2ndFlrSF LowQualFinSF GrLivArea BsmtFullBath BsmtHalfBath FullBath
1       856       854            0      1710            1            0        2
2      1262         0            0      1262            0            1        2
3       920       866            0      1786            1            0        2
4       961       756            0      1717            1            0        1
5      1145      1053            0      2198            1            0        2
6       796       566            0      1362            1            0        1
  HalfBath BedroomAbvGr KitchenAbvGr KitchenQual TotRmsAbvGrd Functional
1        1            3            1          Gd            8        Typ
2        0            3            1          TA            6        Typ
3        1            3            1          Gd            6        Typ
4        0            3            1          Gd            7        Typ
5        1            4            1          Gd            9        Typ
6        1            1            1          TA            5        Typ
  Fireplaces FireplaceQu GarageType GarageYrBlt GarageFinish GarageCars
1          0        &lt;NA&gt;     Attchd        2003          RFn          2
2          1          TA     Attchd        1976          RFn          2
3          1          TA     Attchd        2001          RFn          2
4          1          Gd     Detchd        1998          Unf          3
5          1          TA     Attchd        2000          RFn          3
6          0        &lt;NA&gt;     Attchd        1993          Unf          2
  GarageArea GarageQual GarageCond PavedDrive WoodDeckSF OpenPorchSF
1        548         TA         TA          Y          0          61
2        460         TA         TA          Y        298           0
3        608         TA         TA          Y          0          42
4        642         TA         TA          Y          0          35
5        836         TA         TA          Y        192          84
6        480         TA         TA          Y         40          30
  EnclosedPorch X3SsnPorch ScreenPorch PoolArea PoolQC Fence MiscFeature
1             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
2             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
3             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
4           272          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
5             0          0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;
6             0        320           0        0   &lt;NA&gt; MnPrv        Shed
  MiscVal MoSold YrSold SaleType SaleCondition SalePrice
1       0      2   2008       WD        Normal    208500
2       0      5   2007       WD        Normal    181500
3       0      9   2008       WD        Normal    223500
4       0      2   2006       WD       Abnorml    140000
5       0     12   2008       WD        Normal    250000
6     700     10   2009       WD        Normal    143000</code></pre>
</div>
</div>
</section>
<section id="creación-de-clasificación-de-la-variable-de-precios" class="level3">
<h3 class="anchored" data-anchor-id="creación-de-clasificación-de-la-variable-de-precios">1.2. Creación de clasificación de la variable de precios</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p33 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(datos<span class="sc">$</span>SalePrice, <span class="fl">0.33</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p66 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(datos<span class="sc">$</span>SalePrice, <span class="fl">0.66</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">clasificacion =</span> <span class="fu">ifelse</span>(datos<span class="sc">$</span>SalePrice <span class="sc">&lt;</span> p33, <span class="st">"Economicas"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(datos<span class="sc">$</span>SalePrice <span class="sc">&lt;</span> p66, <span class="st">"Intermedias"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Caras"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>clasificacion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uso-de-train-y-test-previos" class="level3">
<h3 class="anchored" data-anchor-id="uso-de-train-y-test-previos">2. Uso de train y test previos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OverallQual  BsmtFinSF1   BsmtUnfSF  X2ndFlrSF    PoolArea     MiscVal
1  0.65125610  0.57522774 -0.94426706  1.1614536 -0.06866822 -0.08765778
2 -0.07181151  1.17159068 -0.64100836 -0.7948909 -0.06866822 -0.08765778
3  0.65125610  0.09287536 -0.30153966  1.1889432 -0.06866822 -0.08765778
4  0.65125610 -0.49910256 -0.06164845  0.9369551 -0.06866822 -0.08765778
5  1.37432370  0.46340969 -0.17480468  1.6173231 -0.06866822 -0.08765778
6 -0.79487911  0.63223302 -1.13889578  0.5017028 -0.06866822  1.32328259
     SalePrice Neighborhood HouseStyle LotConfig clasificacion
1  0.347154270      CollgCr     2Story    Inside         Caras
2  0.007285824      Veenker     1Story       FR2   Intermedias
3  0.535970074      CollgCr     2Story    Inside         Caras
4 -0.515104565      Crawfor     2Story    Corner   Intermedias
5  0.869544659      NoRidge     2Story       FR2         Caras
6 -0.477341404      Mitchel     1.5Fin    Inside   Intermedias</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>porcentaje <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>corte <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos), <span class="fu">nrow</span>(datos) <span class="sc">*</span> porcentaje)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> datos[corte, ]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>corte, ]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">select</span>(train, <span class="sc">-</span>SalePrice)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">select</span>(test, <span class="sc">-</span>SalePrice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="generar-dos-modelos-de-redes-neuronales-predicciones-y-matrices." class="level2">
<h2 class="anchored" data-anchor-id="generar-dos-modelos-de-redes-neuronales-predicciones-y-matrices.">3. Generar dos modelos de redes neuronales, predicciones y matrices.</h2>
<section id="primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo">3.1 Primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">decay =</span> <span class="fl">0.1</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"logistic"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pm1 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="segundo-modelo" class="level2">
<h2 class="anchored" data-anchor-id="segundo-modelo">3.2 Segundo modelo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">decay =</span> <span class="fl">0.1</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"sigmoid"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>pm2 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicciones" class="level2">
<h2 class="anchored" data-anchor-id="predicciones">4. Predicciones</h2>
<section id="predicción-con-primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-primer-modelo">4.1 Predicción con primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>prediccion1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo1, <span class="at">newdata =</span> test)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cfm1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion1, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicción-con-segundo-modelo" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-segundo-modelo">4.2 Predicción con segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>prediccion2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo2, <span class="at">newdata =</span> test)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cfm2 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion2, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="matrices-de-confusión-de-modelos" class="level2">
<h2 class="anchored" data-anchor-id="matrices-de-confusión-de-modelos">5. Matrices de confusión de modelos</h2>
<section id="matriz-de-primer-modelo" class="level3">
<h3 class="anchored" data-anchor-id="matriz-de-primer-modelo">5.1 Matriz de primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cfm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         129          0          22
  Economicas      0        114          33
  Intermedias    23         26          92

Overall Statistics
                                          
               Accuracy : 0.7631          
                 95% CI : (0.7205, 0.8021)
    No Information Rate : 0.3462          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6446          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8487            0.8143             0.6259
Specificity                0.9233            0.8896             0.8322
Pos Pred Value             0.8543            0.7755             0.6525
Neg Pred Value             0.9201            0.9110             0.8154
Prevalence                 0.3462            0.3189             0.3349
Detection Rate             0.2938            0.2597             0.2096
Detection Prevalence       0.3440            0.3349             0.3212
Balanced Accuracy          0.8860            0.8520             0.7290</code></pre>
</div>
</div>
</section>
<section id="matriz-de-segundo-modelo" class="level3">
<h3 class="anchored" data-anchor-id="matriz-de-segundo-modelo">5.2 Matriz de segundo modelo</h3>
<p>La matriz para el segundo modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cfm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         133          3          23
  Economicas      0        105          32
  Intermedias    19         32          92

Overall Statistics
                                          
               Accuracy : 0.7517          
                 95% CI : (0.7085, 0.7914)
    No Information Rate : 0.3462          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6272          
                                          
 Mcnemar's Test P-Value : 0.3365          

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8750            0.7500             0.6259
Specificity                0.9094            0.8930             0.8253
Pos Pred Value             0.8365            0.7664             0.6434
Neg Pred Value             0.9321            0.8841             0.8142
Prevalence                 0.3462            0.3189             0.3349
Detection Rate             0.3030            0.2392             0.2096
Detection Prevalence       0.3622            0.3121             0.3257
Balanced Accuracy          0.8922            0.8215             0.7256</code></pre>
</div>
</div>
</section>
</section>
<section id="comparacion-de-resultados" class="level2">
<h2 class="anchored" data-anchor-id="comparacion-de-resultados">6 Comparacion de resultados</h2>
<section id="red-neuronal-1" class="level3">
<h3 class="anchored" data-anchor-id="red-neuronal-1">Red neuronal 1</h3>
<p>Este modelo obtuvo un accurracy de 0.754 Este modelo obtuvo un tiempo de procesamiento de 3.38 El modelo obtuvo un sensitivity de 0.855 y un specificity de 0.899 indicando asi que modelo no tiene tantas equivocaciones.</p>
</section>
<section id="red-neuronal-2" class="level3">
<h3 class="anchored" data-anchor-id="red-neuronal-2">Red neuronal 2</h3>
<p>Este modelo obtuvo un accurracy de 0.719 Este modelo obtuvo un tiempo de procesamiento de 12.98 El modelo obtuvo un sensitivity de 0.789 y un specificity de 0.919 indicando asi que modelo no tiene tantas equivocaciones.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Segun los datos que se observan anteriormente se puede definir que el mejor modelo de las dos redes neuronales es la primera, la cual tiene una solo una capa de 16 neuronas.</p>
</section>
</section>
<section id="análisis-de-overfitting" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-overfitting">7. Análisis de overfitting</h2>
<section id="primer-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo-1">7.1 Primer modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># datos.task = makeClassifTask(data = train, target = "clasificacion")</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rin2 = makeResampleDesc(method = "CV", iters = 10, predict = "both")</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lrn = makeLearner("classif.nnet", size = 4, decay = 1e-4, maxit = 1000, trace = FALSE)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lc2 = generateLearningCurveData(learners = lrn, task = datos.task,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 percs = seq(0.1, 1, by = 0.1),</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 measures = list(ber, setAggregation(ber, train.mean)), resampling = rin2,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 show.info = FALSE)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plotLearningCurve(lc2, facet = "learner")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tras observar la curva de aprendizaje, se puede notar que la curva de training siempre va en ascenso, mientras mayor cantidad de datos mayor es la curva lo que indica que el modelo no posee un infra ajuste. Por otro lado, al observar la curva de test se nota que al final con el último grupo de datos en lugar de que la curva disminuye va en aumento lo que no debe de pasar, indicando así que el modelo posee sobreajuste. Además, se puede reforzar esta conclusión al notar que las dos curvas nunca llegan a converger y la distancia entre ellas es muy amplia.</p>
</section>
<section id="segundo-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="segundo-modelo-1">7.2 Segundo modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># datos.task = makeClassifTask(data = train, target = "clasificacion")</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rin2 = makeResampleDesc(method = "CV", iters = 10, predict = "both")</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lrn = makeLearner("classif.nnet", size = 16, decay = 1e-4, maxit = 1000, trace = FALSE)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lc2 = generateLearningCurveData(learners = lrn, task = datos.task,</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 percs = seq(0.1, 1, by = 0.1),</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 measures = list(ber, setAggregation(ber, train.mean)), resampling = rin2,</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                                 show.info = FALSE)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plotLearningCurve(lc2, facet = "learner")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El segundo modelo se evidencia en su curva de aprendizaje que tiene overfitting. Se aprecia que la curva de entrenamiento sube cuando se tienen más datos, lo cual indica que el modelo se está ajustando mucho a ellos. Además, existe un espacio demasiado grande entre curvas. Este sobreajuste se puede deber a que la complejidad del modelo es demasiado alta para los datos que se tienen. También es posible que se tengan muy pocos datos y/o features.</p>
</section>
</section>
<section id="tuneo-de-parametros" class="level2">
<h2 class="anchored" data-anchor-id="tuneo-de-parametros">8. Tuneo de parametros</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">10</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">decay =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">1.25</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>modelo_tuneado <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> train, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">method =</span> <span class="st">"nnet"</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">trace =</span> F, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">tuneGrid =</span> grid, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">maxit =</span> <span class="dv">100</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>modelo_tuneado<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   size decay
15    6   1.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_tuneado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a 41-6-3 network with 273 weights
options were - softmax modelling  decay=1.5
  b-&gt;h1  i1-&gt;h1  i2-&gt;h1  i3-&gt;h1  i4-&gt;h1  i5-&gt;h1  i6-&gt;h1  i7-&gt;h1  i8-&gt;h1  i9-&gt;h1 
  -0.18   -0.73   -0.53   -0.26   -0.39   -0.02   -0.10    0.13    0.55    0.30 
i10-&gt;h1 i11-&gt;h1 i12-&gt;h1 i13-&gt;h1 i14-&gt;h1 i15-&gt;h1 i16-&gt;h1 i17-&gt;h1 i18-&gt;h1 i19-&gt;h1 
  -0.40   -0.07   -0.41    0.34   -0.52    0.25    0.33    0.06   -0.06   -0.02 
i20-&gt;h1 i21-&gt;h1 i22-&gt;h1 i23-&gt;h1 i24-&gt;h1 i25-&gt;h1 i26-&gt;h1 i27-&gt;h1 i28-&gt;h1 i29-&gt;h1 
  -0.09   -0.12   -0.22    0.69    0.02   -0.20   -0.32   -0.02    0.15   -0.17 
i30-&gt;h1 i31-&gt;h1 i32-&gt;h1 i33-&gt;h1 i34-&gt;h1 i35-&gt;h1 i36-&gt;h1 i37-&gt;h1 i38-&gt;h1 i39-&gt;h1 
  -0.17    0.26   -0.42    0.03    0.12   -0.11    0.00   -0.67   -0.24    0.04 
i40-&gt;h1 i41-&gt;h1 
   0.00    0.02 
  b-&gt;h2  i1-&gt;h2  i2-&gt;h2  i3-&gt;h2  i4-&gt;h2  i5-&gt;h2  i6-&gt;h2  i7-&gt;h2  i8-&gt;h2  i9-&gt;h2 
   0.21    0.76    0.56    0.24    0.38    0.01    0.11   -0.14   -0.58   -0.33 
i10-&gt;h2 i11-&gt;h2 i12-&gt;h2 i13-&gt;h2 i14-&gt;h2 i15-&gt;h2 i16-&gt;h2 i17-&gt;h2 i18-&gt;h2 i19-&gt;h2 
   0.40    0.06    0.41   -0.35    0.56   -0.26   -0.35   -0.06    0.07    0.01 
i20-&gt;h2 i21-&gt;h2 i22-&gt;h2 i23-&gt;h2 i24-&gt;h2 i25-&gt;h2 i26-&gt;h2 i27-&gt;h2 i28-&gt;h2 i29-&gt;h2 
   0.11    0.11    0.23   -0.69    0.03    0.21    0.34    0.02   -0.15    0.18 
i30-&gt;h2 i31-&gt;h2 i32-&gt;h2 i33-&gt;h2 i34-&gt;h2 i35-&gt;h2 i36-&gt;h2 i37-&gt;h2 i38-&gt;h2 i39-&gt;h2 
   0.17   -0.27    0.45   -0.05   -0.12    0.13    0.01    0.72    0.24   -0.04 
i40-&gt;h2 i41-&gt;h2 
   0.00   -0.01 
  b-&gt;h3  i1-&gt;h3  i2-&gt;h3  i3-&gt;h3  i4-&gt;h3  i5-&gt;h3  i6-&gt;h3  i7-&gt;h3  i8-&gt;h3  i9-&gt;h3 
  -0.16   -0.78   -0.59   -0.31   -0.42   -0.06   -0.15    0.12    0.47    0.22 
i10-&gt;h3 i11-&gt;h3 i12-&gt;h3 i13-&gt;h3 i14-&gt;h3 i15-&gt;h3 i16-&gt;h3 i17-&gt;h3 i18-&gt;h3 i19-&gt;h3 
  -0.42   -0.09   -0.41    0.32   -0.41    0.24    0.28    0.06   -0.02   -0.05 
i20-&gt;h3 i21-&gt;h3 i22-&gt;h3 i23-&gt;h3 i24-&gt;h3 i25-&gt;h3 i26-&gt;h3 i27-&gt;h3 i28-&gt;h3 i29-&gt;h3 
  -0.05   -0.14   -0.23    0.69    0.15   -0.16   -0.30   -0.02    0.16   -0.15 
i30-&gt;h3 i31-&gt;h3 i32-&gt;h3 i33-&gt;h3 i34-&gt;h3 i35-&gt;h3 i36-&gt;h3 i37-&gt;h3 i38-&gt;h3 i39-&gt;h3 
  -0.20    0.23   -0.43    0.00    0.10   -0.07    0.00   -0.54   -0.22    0.04 
i40-&gt;h3 i41-&gt;h3 
   0.01    0.02 
  b-&gt;h4  i1-&gt;h4  i2-&gt;h4  i3-&gt;h4  i4-&gt;h4  i5-&gt;h4  i6-&gt;h4  i7-&gt;h4  i8-&gt;h4  i9-&gt;h4 
   0.12    0.72    0.54    0.31    0.41    0.05    0.11   -0.12   -0.46   -0.21 
i10-&gt;h4 i11-&gt;h4 i12-&gt;h4 i13-&gt;h4 i14-&gt;h4 i15-&gt;h4 i16-&gt;h4 i17-&gt;h4 i18-&gt;h4 i19-&gt;h4 
   0.42    0.11    0.41   -0.34    0.41   -0.24   -0.27   -0.06    0.00    0.05 
i20-&gt;h4 i21-&gt;h4 i22-&gt;h4 i23-&gt;h4 i24-&gt;h4 i25-&gt;h4 i26-&gt;h4 i27-&gt;h4 i28-&gt;h4 i29-&gt;h4 
   0.05    0.14    0.21   -0.72   -0.15    0.16    0.29    0.02   -0.16    0.14 
i30-&gt;h4 i31-&gt;h4 i32-&gt;h4 i33-&gt;h4 i34-&gt;h4 i35-&gt;h4 i36-&gt;h4 i37-&gt;h4 i38-&gt;h4 i39-&gt;h4 
   0.20   -0.22    0.41    0.00   -0.10    0.05   -0.01    0.54    0.23   -0.03 
i40-&gt;h4 i41-&gt;h4 
  -0.01   -0.07 
  b-&gt;h5  i1-&gt;h5  i2-&gt;h5  i3-&gt;h5  i4-&gt;h5  i5-&gt;h5  i6-&gt;h5  i7-&gt;h5  i8-&gt;h5  i9-&gt;h5 
  -0.37    0.91    0.91    0.63    0.82    0.16   -0.04    0.00    0.01    0.34 
i10-&gt;h5 i11-&gt;h5 i12-&gt;h5 i13-&gt;h5 i14-&gt;h5 i15-&gt;h5 i16-&gt;h5 i17-&gt;h5 i18-&gt;h5 i19-&gt;h5 
   0.30    0.40    0.29   -0.26   -0.35   -0.20    0.01   -0.15   -0.45    0.25 
i20-&gt;h5 i21-&gt;h5 i22-&gt;h5 i23-&gt;h5 i24-&gt;h5 i25-&gt;h5 i26-&gt;h5 i27-&gt;h5 i28-&gt;h5 i29-&gt;h5 
  -0.18    0.24    0.10   -0.75   -0.35   -0.04    0.10   -0.10   -0.24    0.06 
i30-&gt;h5 i31-&gt;h5 i32-&gt;h5 i33-&gt;h5 i34-&gt;h5 i35-&gt;h5 i36-&gt;h5 i37-&gt;h5 i38-&gt;h5 i39-&gt;h5 
   0.14    0.00    0.26    0.19    0.00   -0.33   -0.05   -0.26    0.40   -0.33 
i40-&gt;h5 i41-&gt;h5 
  -0.08   -0.22 
  b-&gt;h6  i1-&gt;h6  i2-&gt;h6  i3-&gt;h6  i4-&gt;h6  i5-&gt;h6  i6-&gt;h6  i7-&gt;h6  i8-&gt;h6  i9-&gt;h6 
   0.47   -0.92   -1.05   -0.77   -0.91   -0.16    0.03   -0.01   -0.04   -0.40 
i10-&gt;h6 i11-&gt;h6 i12-&gt;h6 i13-&gt;h6 i14-&gt;h6 i15-&gt;h6 i16-&gt;h6 i17-&gt;h6 i18-&gt;h6 i19-&gt;h6 
  -0.29   -0.44   -0.25    0.25    0.39    0.21   -0.02    0.16    0.51   -0.27 
i20-&gt;h6 i21-&gt;h6 i22-&gt;h6 i23-&gt;h6 i24-&gt;h6 i25-&gt;h6 i26-&gt;h6 i27-&gt;h6 i28-&gt;h6 i29-&gt;h6 
   0.19   -0.24   -0.11    0.79    0.34    0.06   -0.11    0.17    0.26   -0.07 
i30-&gt;h6 i31-&gt;h6 i32-&gt;h6 i33-&gt;h6 i34-&gt;h6 i35-&gt;h6 i36-&gt;h6 i37-&gt;h6 i38-&gt;h6 i39-&gt;h6 
  -0.10   -0.02   -0.22   -0.21   -0.01    0.38    0.05    0.32   -0.44    0.38 
i40-&gt;h6 i41-&gt;h6 
   0.10    0.24 
 b-&gt;o1 h1-&gt;o1 h2-&gt;o1 h3-&gt;o1 h4-&gt;o1 h5-&gt;o1 h6-&gt;o1 
  0.00  -1.00   0.97  -1.16   1.16   2.04  -2.21 
 b-&gt;o2 h1-&gt;o2 h2-&gt;o2 h3-&gt;o2 h4-&gt;o2 h5-&gt;o2 h6-&gt;o2 
 -0.01   1.79  -1.87   1.71  -1.68  -0.87   0.82 
 b-&gt;o3 h1-&gt;o3 h2-&gt;o3 h3-&gt;o3 h4-&gt;o3 h5-&gt;o3 h6-&gt;o3 
  0.01  -0.79   0.90  -0.55   0.53  -1.17   1.40 </code></pre>
</div>
</div>
<div class="cell">

</div>
<p>Al utilizar crossvalidation con parameter tuning, se obtuvo que la mejor cantidad de neuronas es 10 y el mejor decay es 1.26 aproximadamente. No se muestra porque la ejecución del código es muy extensa. A pesar de que estos valores puede que mejoren un poco el accuracy, el overfitting es muy probable que se mantenga.</p>
<section id="modelo-tuneado" class="level3">
<h3 class="anchored" data-anchor-id="modelo-tuneado">8.2 Modelo Tuneado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="at">memory.profiling =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>modelo3 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(clasificacion <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"nnet"</span>, <span class="at">trace =</span> F, <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">decay =</span> <span class="fl">1.258925</span>), <span class="at">nnet =</span> <span class="fu">list</span>(<span class="at">droput =</span> <span class="fl">0.5</span>), <span class="at">activation =</span> <span class="st">"logistic"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Rprof</span>(<span class="cn">NULL</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>pm3 <span class="ot">&lt;-</span> <span class="fu">summaryRprof</span>(<span class="at">memory =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prediccion3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3, <span class="at">newdata =</span> test)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cfm3 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(prediccion3, test<span class="sc">$</span>clasificacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cfm3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

             Reference
Prediction    Caras Economicas Intermedias
  Caras         130          0          17
  Economicas      0        111          30
  Intermedias    22         29         100

Overall Statistics
                                          
               Accuracy : 0.7768          
                 95% CI : (0.7349, 0.8149)
    No Information Rate : 0.3462          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.665           
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Caras Class: Economicas Class: Intermedias
Sensitivity                0.8553            0.7929             0.6803
Specificity                0.9408            0.8997             0.8253
Pos Pred Value             0.8844            0.7872             0.6623
Neg Pred Value             0.9247            0.9027             0.8368
Prevalence                 0.3462            0.3189             0.3349
Detection Rate             0.2961            0.2528             0.2278
Detection Prevalence       0.3349            0.3212             0.3440
Balanced Accuracy          0.8980            0.8463             0.7528</code></pre>
</div>
</div>
<p>Se obtuvo un accuracy de 0.77, solo un 0.01 arriba del mejor accuracy anterior. Por lo que no se tiene una diferencia tan significativa para el modelo. Es casi seguro que el overfitting se mantuvo.</p>
</section>
</section>
<section id="selección-de-saleprice-como-variable-respuesta" class="level2">
<h2 class="anchored" data-anchor-id="selección-de-saleprice-como-variable-respuesta">9. Selección de SalePrice como variable respuesta</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>porcentaje <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>corte <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos), <span class="fu">nrow</span>(datos) <span class="sc">*</span> porcentaje)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> datos[corte, ]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>corte, ]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> train[, numeric_variables]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> test[, numeric_variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelos-de-regresión-lineal-con-redes-neuronales." class="level2">
<h2 class="anchored" data-anchor-id="modelos-de-regresión-lineal-con-redes-neuronales.">10. Modelos de regresión lineal con redes neuronales.</h2>
<section id="primer-modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="primer-modelo-2">10.1 Primer modelo</h3>
<div class="cell">

</div>
</section>
<section id="segundo-modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="segundo-modelo-2">10.2 Segundo modelo</h3>
</section>
</section>
<section id="predicción" class="level2">
<h2 class="anchored" data-anchor-id="predicción">11. Predicción</h2>
<section id="predicción-con-primer-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="predicción-con-primer-modelo-1">11.1 Predicción con primer modelo</h3>
<div class="cell">

</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>